vc-preamble: |-


vc-helpers: |-
  lemma UniqueElementsInSeq(s: seq<int>)
    ensures forall i, j :: 0 <= i < j < |s| ==> s[i] != s[j]
  {
  }

vc-spec: |-
  // <vc-spec>
  method RemoveDuplicates(a: array<int>) returns (result: seq<int>)
      requires a != null
      ensures forall x :: x in result <==> exists i :: 0 <= i < a.Length && a[i] == x
      ensures forall i, j :: 0 <= i < j < |result| ==> result[i] != result[j]
  // </vc-spec>

vc-code: |-
  method RemoveDuplicatesImpl(a: array<int>) returns (result: seq<int>)
    requires a.Length >= 0
    ensures forall x :: x in result <==> exists i :: 0 <= i < a.Length && a[i] == x
    ensures forall i, j :: 0 <= i < j < |result| ==> result[i] != result[j]
  {
    var seen: set<int> := {};
    result := [];
    
    for i := 0 to a.Length
      invariant 0 <= i <= a.Length
      invariant forall x :: x in result <==> exists k :: 0 <= k < i && a[k] == x
      invariant forall m, n :: 0 <= m < n < |result| ==> result[m] != result[n]
      invariant seen == set x | x in result
    {
      if i < a.Length && a[i] !in seen
      {
        seen := seen + {a[i]};
        result := result + [a[i]];
      }
    }
  }

vc-postamble: |-


