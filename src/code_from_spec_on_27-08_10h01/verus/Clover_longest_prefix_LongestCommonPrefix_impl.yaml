vc-preamble: |-
  use vstd::prelude::*;
  
  verus! {

vc-helpers: |-


vc-spec: |-
  // <vc-spec>
  fn longest_common_prefix(str1: Seq<char>, str2: Seq<char>) -> (prefix: Seq<char>)
      ensures 
          prefix.len() <= str1.len() && prefix == str1.subrange(0, prefix.len() as int) &&
          prefix.len() <= str2.len() && prefix == str2.subrange(0, prefix.len() as int),
          prefix.len() == str1.len() || prefix.len() == str2.len() || 
          (str1[prefix.len() as int] != str2[prefix.len() as int])
  // </vc-spec>

vc-code: |-
  {
      let min_len = if str1.len() <= str2.len() { str1.len() } else { str2.len() };
      let mut i: usize = 0;
      
      while i < min_len
          invariant
              i <= min_len,
              min_len <= str1.len(),
              min_len <= str2.len(),
              forall|j: int| 0 <= j < i ==> str1[j] == str2[j]
      {
          if str1[i as int] != str2[i as int] {
              break;
          }
          i += 1;
      }
      
      str1.subrange(0, i as int)
  }

vc-postamble: |-
  fn main() {
  }
  
  }

