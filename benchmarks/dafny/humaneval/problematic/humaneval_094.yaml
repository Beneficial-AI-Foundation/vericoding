vc-description: |-
  This verification task involves implementing a method that finds the largest prime number in a given list of integers and returns the sum of its digits. If no prime number exists in the list, the method should return 0. The implementation requires helper functions for prime checking and digit sum calculation.

vc-preamble: |2-

  function is_prime_pure(n: int): bool
  {
      n >= 2 && (forall k :: 2 <= k < n ==> n % k != 0)
  }

  function sum_of_digits_pure(n: int): int
      requires n >= 0
  {
      if n < 10 then n else (n % 10) + sum_of_digits_pure(n / 10)
  }
  method is_prime(n: int) returns (prime: bool)
      ensures prime == is_prime_pure(n)
  {
      if n < 2 {
          return false;
      }
      if n == 2 {
          return true;
      }
      if n % 2 == 0 {
          return false;
      }

      var i := 3;
      while i * i <= n
          invariant 3 <= i
          invariant i % 2 == 1
          invariant forall k :: 2 <= k < i ==> n % k != 0
          invariant n >= 2
      {
          if n % i == 0 {
              return false;
          }
          i := i + 2;
      }

      assert forall k :: 2 <= k < n ==> n % k != 0 by {
          forall k | 2 <= k < n 
          ensures n % k != 0
          {
              if k < i {
              } else {
                  assert k >= i;
                  assert i * i > n;
                  if n % k == 0 {
                      var m := n / k;
                      assert n == k * m;
                      assert m >= 1;
                      if m == 1 {
                          assert n == k;
                          assert k < n;
                          assert false;
                      } else {
                          assert m >= 2;
                          assert k * m == n;
                          assert k >= i;
                          assert i * i > n;
                          assert k * m < k * k;
                          assert m < k;
                          assert m < i;
                          assert n % m == 0;
                          assert false;
                      }
                  }
              }
          }
      }
      return true;
  }

  function sum_of_digits(n: int): int
      requires n >= 0
      ensures sum_of_digits(n) == sum_of_digits_pure(n)
      ensures sum_of_digits(n) >= 0
  {
      if n < 10 then n
      else (n % 10) + sum_of_digits(n / 10)
  }

vc-helpers: |

vc-spec: |-
  method skjkasdkd(lst: seq<int>) returns (result: int)
      ensures result >= 0
      ensures (forall x :: x in lst ==> !is_prime_pure(x)) ==> result == 0
      ensures (exists x :: x in lst && is_prime_pure(x)) ==> 
          (exists largest :: (largest in lst && is_prime_pure(largest) && 
           (forall y :: y in lst && is_prime_pure(y) ==> y <= largest) &&
           result == sum_of_digits_pure(largest)))

vc-code: |-
  {
      assume {:axiom} false;
    }
vc-postamble: |
