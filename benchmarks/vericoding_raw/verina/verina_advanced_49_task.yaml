vc-description: |-
  /--
  -----Description-----
  Implement a Lean 4 function that merges two ascendingly sorted lists of integers into one single sorted list (ascending). The resulting list must contain all elements from both input lists, preserving their ascending order.

  -----Input-----
  The input consists of two lists of integers:
  arr1: A sorted list of integers (ascending)
  arr2: Another sorted list of integers (ascending)

  -----Output-----
  The output is a list of integers:
  Returns a new list containing all elements from arr1 and arr2, sorted in ascending order.
  -/

vc-preamble: |-

vc-helpers: |-
  -- <vc-helpers>
  -- </vc-helpers>

vc-signature: |-
  def mergeSortedLists (arr1 : List Int) (arr2 : List Int) (h_precond : mergeSortedLists_precond (arr1) (arr2)) : List Int :=

vc-implementation: |-
  -- <vc-implementation>
    let rec merge (xs : List Int) (ys : List Int) : List Int :=
      match xs, ys with
      | [], _ => ys
      | _, [] => xs
      | x :: xt, y :: yt =>
        if x <= y then
          x :: merge xt (y :: yt)
        else
          y :: merge (x :: xt) yt
  
    merge arr1 arr2
  -- </vc-implementation>
  
vc-condition: |-
  @[reducible]
  def mergeSortedLists_precond (arr1 : List Int) (arr2 : List Int) : Prop :=
    List.Pairwise (· ≤ ·) arr1 ∧ List.Pairwise (· ≤ ·) arr2

  @[reducible]
  def mergeSortedLists_postcond (arr1 : List Int) (arr2 : List Int) (result: List Int) (h_precond : mergeSortedLists_precond (arr1) (arr2)) : Prop :=
    List.Pairwise (· ≤ ·) result ∧ List.isPerm (arr1 ++ arr2) result

  theorem mergeSortedLists_spec_satisfied (arr1: List Int) (arr2: List Int) (h_precond : mergeSortedLists_precond (arr1) (arr2)) :
      mergeSortedLists_postcond (arr1) (arr2) (mergeSortedLists (arr1) (arr2) h_precond) h_precond := by

vc-proof: |-
  -- <vc-proof>
    sorry
  -- </vc-proof>

vc-postamble: |-
  /-
  -- Invalid Inputs
  [
      {
          "input": {
              "arr1": "[3, 2, 1]",
              "arr2": "[6, 5, 4]"
          }
      }
  ]
  -- Tests
  [
      {
          "input": {
              "arr1": "[1, 3, 5]",
              "arr2": "[2, 4, 6]"
          },
          "expected": "[1, 2, 3, 4, 5, 6]",
          "unexpected": [
              "[1, 3, 5]",
              "[2, 4, 6]",
              "[1, 3, 2, 4, 5, 6]"
          ]
      },
      {
          "input": {
              "arr1": "[]",
              "arr2": "[]"
          },
          "expected": "[]",
          "unexpected": [
              "[0]",
              "[999]"
          ]
      },
      {
          "input": {
              "arr1": "[-2, 0, 1]",
              "arr2": "[-3, -1]"
          },
          "expected": "[-3, -2, -1, 0, 1]",
          "unexpected": [
              "[-3, -1]",
              "[0, 1]",
              "[-2, 0, 1]"
          ]
      },
      {
          "input": {
              "arr1": "[10, 20, 30]",
              "arr2": "[5, 25, 35]"
          },
          "expected": "[5, 10, 20, 25, 30, 35]",
          "unexpected": [
              "[10, 20, 30]",
              "[5, 25, 35]",
              "[10, 20, 25, 30, 35]"
          ]
      },
      {
          "input": {
              "arr1": "[1, 2, 2]",
              "arr2": "[2, 3, 3]"
          },
          "expected": "[1, 2, 2, 2, 3, 3]",
          "unexpected": [
              "[1, 2, 3]",
              "[2, 2, 2, 3, 3]"
          ]
      }
  ]
  -/
