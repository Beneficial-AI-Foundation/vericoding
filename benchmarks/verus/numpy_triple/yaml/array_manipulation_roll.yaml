vc-description: |-
  Roll array elements along a given axis by cyclically shifting elements.
  Elements that roll beyond the last position are re-introduced at the first.
  
  Specification: roll cyclically shifts array elements by the given amount.
  For positive shift, elements move to the right and wrap around.
  For negative shift, elements move to the left and wrap around.
  Empty vectors are returned unchanged.

  Mathematical property: result[i] = a[(i - shift) mod n]
  where the modulo operation handles negative values correctly.

vc-preamble: |-
  use vstd::prelude::*;

  verus! {

vc-helpers: |-

vc-spec: |-
  spec fn normalize_index(i: int, shift: int, n: int) -> int {
      let src_idx = i - shift;
      let mod_result = src_idx % n;
      if mod_result < 0 { mod_result + n } else { mod_result }
  }

  fn roll<T>(a: Vec<T>, shift: i32) -> (result: Vec<T>)
      ensures
          result.len() == a.len(),
          a.len() == 0 ==> result@ == a@,
          a.len() > 0 ==> forall|i: int| 0 <= i < a.len() ==> #[trigger] result[i] == a[normalize_index(i, shift as int, a.len() as int)]

vc-code: |-
  {
      // impl-start
      assume(false);
      unreached()
      // impl-end
  }

vc-postamble: |-

  }
  fn main() {}