vc-description: |-
  Compute the q-th percentile of the data in a vector.
  For a sorted vector, the q-th percentile is the value below which q percent of the data falls.
  This implementation focuses on the fundamental mathematical definition of percentiles.
  
  Specification: percentile computes the q-th percentile value correctly.
  The percentile is defined as the value v such that at least q% of the data
  is less than or equal to v, and at least (100-q)% of the data is greater than or equal to v.
  
  Mathematical properties:
  1. The percentile value must be within the range of the data (or interpolated between values)
  2. Special cases: q=0 gives minimum, q=100 gives maximum
  3. The result is bounded by the minimum and maximum values in the array

vc-preamble: |-
  use vstd::prelude::*;
  
  verus! {

vc-helpers: |-

vc-spec: |-
  fn percentile(arr: Vec<i8>, q: i8) -> (result: i8)
      requires 
          arr.len() > 0,
          0 <= q && q <= 100,
      ensures
          (forall|i: int| 0 <= i < arr.len() ==> arr[i] as int <= result as int ==> 
              exists|j: int| 0 <= j < arr.len() && arr[j] as int >= result as int) &&
          (forall|i: int| 0 <= i < arr.len() ==> arr[i] as int >= result as int ==> 
              exists|j: int| 0 <= j < arr.len() && arr[j] as int <= result as int) &&
          (q == 0 ==> forall|i: int| 0 <= i < arr.len() ==> result as int <= arr[i] as int) &&
          (q == 100 ==> forall|i: int| 0 <= i < arr.len() ==> arr[i] as int <= result as int)

vc-code: |-
  {
      assume(false);
      unreached()
  }

vc-postamble: |-
  }
  fn main() {}