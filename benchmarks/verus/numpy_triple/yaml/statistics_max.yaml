vc-description: |-
  Returns the maximum value of all elements in a non-empty vector.
  This is an alias for numpy.amax that returns the maximum value among all elements in the array.

  Mathematical Properties:
  - Returns an element that exists in the vector
  - No element in the vector is greater than the returned value
  - For constant vectors, returns the constant value
  - Handles non-empty vectors only (n + 1 elements)

  Specification: max returns the maximum value in the vector.
  This specification delegates to amax_spec since max is an alias for amax.

  Mathematical properties:
  1. The result is an element that exists in the vector
  2. No element in the vector is greater than the result
  3. The result is unique (first occurrence if there are duplicates)
  4. For constant vectors, max equals the constant value
  5. Sanity check: the maximum exists in the vector

vc-preamble: |-
  use vstd::prelude::*;

  verus! {

vc-helpers: |-

vc-spec: |-
  fn max(a: Vec<i8>) -> (result: i8)
      requires a.len() > 0,
      ensures
          /* Core property: result is the maximum element in the vector */
          exists|max_idx: int| 0 <= max_idx < a@.len() &&
              result as int == a@[max_idx] &&
              forall|i: int| 0 <= i < a@.len() ==> a@[i] <= result as int,
          /* Uniqueness: result is the first occurrence of the maximum */
          exists|first_max_idx: int| 0 <= first_max_idx < a@.len() &&
              result as int == a@[first_max_idx] &&
              (forall|i: int| 0 <= i < a@.len() && a@[i] == result as int ==> first_max_idx <= i) &&
              (forall|i: int| 0 <= i < a@.len() ==> a@[i] <= result as int),
          /* For constant vectors, max equals the constant */
          (forall|i: int, j: int| 0 <= i < a@.len() && 0 <= j < a@.len() ==> a@[i] == a@[j]) ==>
              result as int == a@[0],
          /* Sanity check: the maximum exists in the vector */
          exists|witness: int| 0 <= witness < a@.len() && result as int == a@[witness],

vc-code: |-
  {
      // impl-start
      assume(false);
      0
      // impl-end
  }

vc-postamble: |-

  }
  fn main() {}